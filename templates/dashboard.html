{% extends 'basePlusNavbar.html' %}

{% block head %}
    <title>Dashboard</title>
{% endblock %}

{% block body %}
<body class='background_dashboard'>

    <div id='container'>

        <!-- LEFT PANEL -->
        <div class='sidePanel background border spacing'>
            
            <img class='resizeImg128' src='/static/avatars/{{ player["file_name"] }}'>

            <!-- Player Info Panel -->
            <div id='playerInfo'>
                <h3 class='alignCenter'><strong>{{ player['display_name'] }}</strong> ({{ player['player_level'] }})</h3>
                <h4><strong>{{ player['class_name'] }}</strong></h4>

                <hr>

                <div>
                    <table class='alignLeft'>
                        <tr>
                            <td>
                                <img class='iconImg' src='/static/icons/icon_honor.png'>
                                <p>{{ player['honor'] }}</p>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <img class='iconImg' src='/static/icons/icon_gold.png'>
                                <p>{{ player['gold'] }}</p>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <img class='iconImg' src='/static/icons/icon_xp.png'>
                                <p>{{ player['exp_until_level'] }} / 150</p>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <img class='iconImg' src='/static/icons/icon_stamina.png'>
                                <p>{{ player['stamina'] }} / 100</p>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>

            <hr>

            <div>
                <table class='leftRightTable'>
                    <tr>
                        <td>
                            <h5>Strength</h5>
                        </td>
                        <td>
                            <p id='playerStrength' class='sameLine'>{{ player['strength'] }}</p>
                            (<p id='playerPlusStrength' class='sameLine textGreen'>0</p>)
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <h5>Dexterity</h5>
                        </td>
                        <td>
                            <p id='playerDexterity' class='sameLine'>{{ player['dexterity'] }}</p>
                            (<p id='playerPlusDexterity' class='sameLine textGreen'>0</p>)
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <h5>Intelligence</h5>
                        </td>
                        <td>
                            <p id='playerIntelligence' class='sameLine'>{{ player['intelligence'] }}</p>
                            (<p id='playerPlusIntelligence' class='sameLine textGreen'>0</p>)
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <h5>Constitution</h5>
                        </td>
                        <td>
                            <p id='playerConstitution' class='sameLine'>{{ player['constitution'] }}</p>
                            (<p id='playerPlusConstitution' class='sameLine textGreen'>0</p>)
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <h5>Luck</h5>
                        </td>
                        <td>
                            <p id='playerLuck' class='sameLine'>{{ player['luck'] }}</p>
                            (<p id='playerPlusLuck' class='sameLine textGreen'>0</p>)
                        </td>
                    </tr>
                </table>

            </div>
        </div>

        <!-- Main Panel -->
        <div class='mainPanel background border spacing'>

            <h3 class='header'><strong>Worn Items</strong></h3>

            <div class='inventory'>
                <div>
                    <img src='/static/slots/slot_helmet.png'>
                    <img src='/static/slots/slot_chest.png'>
                    <img src='/static/slots/slot_legs.png'>
                    <img src='/static/slots/slot_gloves.png'>
                    <img src='/static/slots/slot_boots.png'>
                    <img src='/static/weapons/axe2.png'>
                    <img src='/static/weapons/axe3.png'>
                </div>
            </div>

            <hr>

            <h3 class='header'><strong>Inventory</strong></h3>

            <div class='inventory'>
                <div>

                {% for i in range(0,28) %}
                
                    {% if i < player['inventory_space'] %}
                    
                    <!-- TODO - if inventory slot is empty
                        <img src='/static/slots/slot_empty.png'>
                        
                        ELSE
                    -->
                    <img class='itemBorderCommon' src='/static/weapons/dagger1.png'>

                    {% else %}
                        <img class='imgLocked' src='/static/slots/slot_locked.png'>
                    {% endif %}

                {% endfor %}

                </div>

                <!--
                <div>
                    <img class='itemBorderCommon' src='/static/weapons/dagger1.png'>
                    <img class='itemBorderUncommon' src='/static/weapons/dagger2.png'>
                    <img class='itemBorderRare' src='/static/weapons/maul1.png'>
                    <img class='itemBorderLegendary' src='/static/weapons/axe2.png'>
                    <img class='itemBorderUnique' src='/static/weapons/dagger1.png'>
                    <img class='itemBorderMythic' src='/static/weapons/maul2.png'>
                    <img src='/static/slots/slot_empty.png'>
                </div>
                -->
            </div>

        </div>

        <!-- RIGHT PANEL -->
        <div class='sidePanel background border spacing'>

            <!-- Player Stats Panel -->
            <div class='alignCenter'>
                
                <h3>Item Information</h3>

                <hr>

                <img src='/static/weapons/dagger1.png'>

                <h4>Dagger of Blast</h4>

                <h5>Level 15</h5>

                <table class='leftRightTable'>
                    <tr>
                        <td><h5>Weapon Dmg</h5></td>
                        <td><p id='newItemDamage'>22</p></td>
                    </tr>
                    <tr>
                        <td><h5>Armor</h5></td>
                        <td><p id='newItemArmor'>0</p></td>
                    </tr>
                    <tr>
                        <td><h5>Strength</h5></td>
                        <td><p id='newItemStrength'>0</p></td>
                    </tr>
                    <tr>
                        <td><h5>Dexterity</h5></td>
                        <td><p id='newItemDexterity'>0</p></td>
                    </tr>
                    <tr>
                        <td><h5>Intelligence</h5></td>
                        <td><p id='newItemIntelligence'>0</p></td>
                    </tr>
                    <tr>
                        <td><h5>Constitution</h5></td>
                        <td><p id='newItemConstitution'>0</p></td>
                    </tr>
                    <tr>
                        <td><h5>Luck</h5></td>
                        <td><p id='newItemLuck'>0</p></td>
                    </tr>
                    <tr>
                        <td><h5>&nbsp;</h5></td>
                        <td><p>&nbsp;</p></td>
                    </tr>
                    <tr>
                        <td><h5>Worth</h5></td>
                        <td><p id='newItemLuck'>150</p></td>
                    </tr>
                </table>

                <hr>

                <button class='themeMediumButton'>Sell</button>
                <button class='themeMediumButton'>Equip</button>
            </div>
        </div>    
    </div>
    
{% endblock %}

{% block script %}
<script>

    var itemRarities = JSON.parse('{{itemRarities | tojson}}');
    var lvl = 1

    var double = 0.0

    for(var i=0; i<100; i++){
        var dropChance = itemRarities[0][1]
        double = Math.random().toFixed(3)

        for (var x=1; x<itemRarities.length; x++) {  
            if(double < dropChance){
                console.log(itemRarities[x][0])
                break
            }
            else{
                dropChance += itemRarities[x][1]
            }
        }
    }

    function increaseAttribute(id) {
        var attributeLevel = document.getElementById(id).innerText
        var gold = document.getElementById('playerGold').innerText
        var costToUpgrade = parseInt(attributeLevel)
        
        if(gold < costToUpgrade)
            return

        updateInnerText('playerGold', -costToUpgrade)
        updateInnerText('playerPlusStrength', 2)
        updateInnerText(id, 1)
    }

    function updateInnerText(id, increaseBy) {
        var element = document.getElementById(id)
        var current = parseInt(element.innerText)

        if(typeof(current) !== 'number')
            return

        element.innerText = current + increaseBy
    }

</script>
{% endblock %}